<?php
require_once $_SERVER['DOCUMENT_ROOT'].'/3severside/resetSession.php';
reset_session();

// Check if the URL contains an error parameter
$error = isset($_GET['error']) ? $_GET['error'] : ' HELLO ';

// Define an associative array to map error codes to error messages
$errorMessages = [
    'invalid_credentials' => 'Invalid ID or Password. Please try again.',
    'empty_credential' => 'ID and Password are required.',
    'sql_injection_detected' => 'Nice Try.',
];
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In</title>
    <style>
      body { font-family: Arial, sans-serif; background-color: #0e1a40; margin: 0; padding: 0; }
      .container { max-width: 400px; margin: 100px auto; padding: 20px; background-color: #ffffff; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
      h2 { margin-top: 0; text-align: center; color: #2a4a75; }
      form { margin-top: 20px; }
      .form-group { margin-bottom: 20px; }
      label { display: block; font-weight: bold; margin-bottom: 5px; color: #2a4a75; }
      input[type="text"], input[type="password"] { width: 100%; height: 40px; font-size: 16px; padding: 8px; border: 1px solid #5579a1; border-radius: 4px; box-sizing: border-box; background-color: #f0f5f9; color: #333; }
      .error-message { color: red; font-size: 14px; margin-top: 10px; margin-bottom: 20px; }
      .btn { width: 100%; height: 40px; font-size: 16px; font-weight: bold; color: #ffffff; background-color: #a7845d; border: none; border-radius: 4px; cursor: pointer; }
      .btn:hover { background-color: #725829; }
      .text-center { text-align: center; }
      .text-gray { color: #888; }
      .link { color: #a7845d; text-decoration: none; }
      .link:hover { text-decoration: underline; }
    </style>
  </head>
  <body>

  <div class="container">
    <h2>Sign In</h2>
    <form name="member" action="auth.php" method="post" ENCTYPE="multipart/form-data" onsubmit="return validateForm()">
        <div class="form-group">
            <label for="id">ID</label>
            <input type="text" name="id" id="id" placeholder="Enter your ID">
        </div>
        <div class="form-group">
            <label for="passwd">Password</label>
            <input type="password" name="passwd" id="passwd" placeholder="Enter your password">
        </div>
        <!-- Display error message if error parameter exists -->
        <?php if (!empty($error) && isset($errorMessages[$error])): ?>
            <div id="error-msg" class="error-message"><?php echo $errorMessages[$error]; ?></div>
        <?php endif; ?>
        <button type="submit" class="btn">Sign In</button>
    </form>
    <div class="text-center">
        <p class="text-gray">Don't have an account? <a href="signup.php" class="link">Sign up here</a></p>
    </div>
  </div>

  <script>
    function validateForm() {
      var id = document.getElementById('id').value;
      var passwd = document.getElementById('passwd').value;
      var errorMsg = '';

      if (id.trim() === '') {
        if (passwd.trim() === '')      { document.getElementById('error-msg').innerHTML = 'ID and Password are required.'; } 
        else                           { document.getElementById('error-msg').innerHTML = 'ID is required.'; }
        return false;
      } else if (passwd.trim() === '') { document.getElementById('error-msg').innerHTML = 'Password is required.'; return false;}

      return true; // Allow form submission
    }
  </script>

  </body>
</html>
