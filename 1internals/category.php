<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; background-color: #0e1a40; color: #ffffff; margin: 0; padding: 0; }
        .container { max-width: 1000px; margin: 20px auto; padding: 20px; background-color: #22335e; border-radius: 5px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
        h2 { color: #ffffff; text-align: center; margin-bottom: 20px; }
        .category-grid { display: flex; flex-wrap: wrap; list-style-type: none; padding: 0; margin: 0; }
        .category-item { flex-basis: calc(30% - 20px); margin-bottom: 20px; text-align: center; margin-right: 20px; }
        .category-item img { width: 100%; height: auto; border-radius: 5px; }
        .category-item a { display: block; text-decoration: none; color: #ffffff; margin-top: 10px; transition: color 0.3s; cursor: pointer; }
        .category-item a:hover { color: #ffd700; }
        .category-grid .category-item:nth-child(3n) { margin-right: 0; }
    </style>
    <script>
        function redirectToSearch(category) {
            const url = `/?target=search&category=${encodeURIComponent(category)}`;
            console.log('Redirecting to:', url);
            window.top.location.href = url;
        }
    </script>
</head>
<body>
    <div class="container">
        <h2>Item Categories:</h2>
        <ul class="category-grid">
            <?php
            require $_SERVER['DOCUMENT_ROOT'] . '/3severside/database.php';

            // Fetch all categories from the database
            $sql = "SELECT * FROM Categories";
            $result = execute_query($sql);

            // Check if categories exist
            if (mysqli_num_rows($result) > 0) {
                // Display categories
                while ($row = mysqli_fetch_assoc($result)) {
                    $category = urlencode($row['cat']);
                    echo "<li class='category-item'>
                            <a onclick='redirectToSearch(\"{$category}\")'>
                                <img src='/2assets/cat/{$row['cat']}.jpg' alt='{$row['cat']}'>
                            </a>
                            <a onclick='redirectToSearch(\"{$category}\")'>" . htmlspecialchars($row['cat']) . "</a>
                          </li>";
                }                
            } else {
                echo "<p>No categories found.</p>";
            }
            ?>
        </ul>
    </div>
</body>
</html>
